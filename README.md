# Обзор Tarantool

## Введение

Tarantool — это платформа для вычислений в памяти, разработанная Mail.ru Group и выпущенная в open source в 2010 году. Изначально Tarantool был создан для снижения затрат на поддержание крупных кластеров MySQL.

## История создания Tarantool

Mail.ru Group выпустила Tarantool в open source в 2010 году. Разработка началась в 2008 году, внутренней команде разработки потребовалось 2 года, чтобы довести продукт до релизного состояния. Своя СУБД разрабатывалась для уменьшения затрат на проекте Мой Мир.

## Эволюция Tarantool

1. **In-Memory Cache**: Это быстрый кеш, который хранит данные в оперативной памяти для ускорения доступа. Однако он теряет данные при перезапуске системы.
2. **In-Memory Persistent Cache**: Добавлена поддержка сохранения данных на диск для восстановления после сбоев.
3. **In-Memory Cache with Replication**: Введена репликация данных для повышения надежности и устойчивости системы.
4. **In-Memory Key/Value DB**: Переход к модели базы данных ключ/значение.
5. **Multiindex DB**: Поддержка нескольких индексов, что позволяет быстрее находить данные.
6. **In-Memory Multiindex DB with Lua Functions**: Интеграция Lua для создания хранимых процедур и гибкой обработки данных.
7. **In-Memory Multiindex DB with Lua Cooperative Runtime**: Добавление кооперативного runtime для выполнения нескольких операций одновременно.
8. **In-Memory Multiindex DB with Lua App Server**: Включение сервера приложений на Lua.
9. **Hybrid Storage Multiindex DB with SQL and Lua App Server**: Гибридное хранилище с ограниченными функциями SQL и сервером приложений на Lua.

## Tarantool сегодня

Сейчас Tarantool является платформой in-memory вычислений с гибкой схемой данных для эффективного создания высоконагруженных приложений. Продукт делится на две версии:

- **Open Source**: Доступен на GitHub и распространяется по лицензии Simplified BSD.
- **Enterprise**: Включает поддержку решений, enterprise-продукты, обучение и консалтинг.

## Основные фишки

- **In-Memory**: Данные находятся в памяти, что обеспечивает низкую задержку.
- **Один тред доступа**: Избегает проблем конкурентного доступа к данным.
- **Персистентность**: Использует Write Ahead Log (WAL) для записи изменений.
- **Индексы**: Поддержка разнообразных индексов ускоряет поиск.
- **Репликация**: Поддерживает актуальность данных на всех узлах.

## Архитектура Tarantool

Данные организованы в спейсы (аналог таблиц в SQL) и таплы (аналог строк в SQL). Индексы строятся из памяти на арене. Взаимодействие с данными обеспечивается через событийный цикл и файберы (легковесные нити исполнения). 

## Интеграция Lua

Lua выбран за простоту и эффективность, позволяя писать пользовательскую логику рядом с данными и избегать обращения к сети.

## Сервер приложений

Tarantool включает в себя сервер приложений с неблокирующими библиотеками для работы с сетью и данными, обеспечивая как серверную, так и клиентскую функциональность.

## Чем отличается от остальных БД

### От In-Memory платформ:
- **Похожи**: In-memory DB + App Runtime, гибкость кластеризации.
- **Отличия**: Архитектура и набор инструментов.

### От реляционных:
- **Похожи**: Таблицы, индексы, схема данных.
- **Отличия**: Не строгая схема, SQL не основной инструмент.

### От Key-Value:
- **Похожи**: Режим key-value.
- **Отличия**: Вторичные индексы, транзакции, итераторы.

### От документ-ориентированных:
- **Похожи**: Хранение документов.
- **Отличия**: Ограниченная индексация.

### От колоночных:
- Tarantool не колоночная база данных, но может использоваться как агрегирующий слой.

## Кейсы использования

- **Плохие сценарии**: Аналитика (OLAP).
- **Хорошие сценарии**: Высокочастотные микротранзакции (OLTP), профили пользователей, кеш-прокси, брокеры очередей.

## На чем работает Tarantool

- Linux (x86/64), BSD, Mac
- Docker
- Cloud
- ARM, IoT (например, Raspberry Pi)

## Функциональность

Поддерживает разнообразные типы данных и индексов для эффективного хранения и обработки данных.
